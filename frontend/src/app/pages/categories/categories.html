<mat-card class="card">
  <h2>Categories</h2>

  <div class="grid">
    <mat-form-field appearance="outline" class="full">
      <mat-label>Name</mat-label>
      <input matInput [(ngModel)]="name">
    </mat-form-field>

    <div class="actions">
      <button *ngIf="selectedId === null" mat-raised-button color="primary" (click)="add()" [disabled]="loading()">Add Category</button>
      <ng-container *ngIf="selectedId !== null">
        <button mat-raised-button color="primary" (click)="update()" [disabled]="loading()">Save Changes</button>
        <button mat-button (click)="cancelEdit()" [disabled]="loading()">Cancel</button>
      </ng-container>
    </div>
  </div>

  <mat-progress-bar *ngIf="loading()" mode="indeterminate"></mat-progress-bar>

  <div class="table-wrap" *ngIf="rows().length; else empty">
    <table mat-table [dataSource]="rows()">
      <ng-container matColumnDef="id"><th mat-header-cell *matHeaderCellDef>Id</th><td mat-cell *matCellDef="let r">{{r.id}}</td></ng-container>
      <ng-container matColumnDef="name"><th mat-header-cell *matHeaderCellDef>Name</th><td mat-cell *matCellDef="let r">{{r.name}}</td></ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let r">
          <button mat-stroked-button color="primary" (click)="edit(r)">Edit</button>
          <button mat-stroked-button color="warn" (click)="remove(r)">Delete</button>
        </td>
      </ng-container>

      <!-- قائمة ثابتة لضمان الظهور -->
      <tr mat-header-row *matHeaderRowDef="['id','name','actions']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['id','name','actions'];"></tr>
    </table>
  </div>

  <ng-template #empty><div class="empty"><p>No categories yet.</p></div></ng-template>
</mat-card>
